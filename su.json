{
  "tree": [
    {
      "id": "injecao",
      "label": "Injeção",
      "icon": "bi-droplet",
      "children": [
        {
          "id": "injecao_bancada_a",
          "label": "Bancada A",
          "icon": "bi-cpu",
          "widgets": [
            {
              "type": "slider",
              "title": "Tempo de Injeção",
              "help": "Ajusta o tempo de injeção da bancada A",
              "command": "tipologia/b_a/tempo_100",
              "min": 0,
              "max": 22,
              "default": 14,
              "unit": "ms",
              "parameterCommand": "motor_type",
              "defaultVariation": "1",
              "parameterVariations": {
                "1": {
                  "title": "Tempo de Injeção (Motor 1 - Gasolina)",
                  "min": 0,
                  "max": 15,
                  "default": 10,
                  "help": "Calibração para motor a gasolina"
                },
                "2": {
                  "title": "Tempo de Injeção (Motor 2 - Álcool)",
                  "min": 0,
                  "max": 22,
                  "default": 14,
                  "help": "Calibração para motor a álcool"
                },
                "3": {
                  "title": "Tempo de Injeção (Motor 3 - Flex)",
                  "min": 0,
                  "max": 25,
                  "default": 12,
                  "help": "Calibração para motor flex fuel"
                }
              }
            },
            {
              "type": "spinbox",
              "title": "Correção de Combustível",
              "help": "Correção percentual de combustível",
              "command": "fuel_corr_a",
              "min": -50,
              "max": 50,
              "default": 0,
              "step": 1,
              "unit": "%",
              "parameterCommand": "motor_type",
              "defaultVariation": "1",
              "parameterVariations": {
                "1": {
                  "title": "Correção de Combustível (Gasolina)",
                  "min": -30,
                  "max": 30,
                  "step": 1,
                  "help": "Faixa otimizada para gasolina"
                },
                "2": {
                  "title": "Correção de Combustível (Álcool)",
                  "min": -50,
                  "max": 50,
                  "step": 2,
                  "help": "Faixa otimizada para álcool (maior variação)"
                },
                "3": {
                  "title": "Correção de Combustível (Flex)",
                  "min": -40,
                  "max": 40,
                  "step": 1,
                  "help": "Faixa otimizada para flex fuel"
                }
              }
            },
            {
              "type": "toggle",
              "title": "Ativar Bancada A",
              "help": "Liga ou desliga a bancada A",
              "command": "bank_a_enable",
              "default": true
            }
          ]
        },
        {
          "id": "injecao_bancada_b",
          "label": "Bancada B",
          "icon": "bi-cpu",
          "widgets": [
            {
              "type": "slider",
              "title": "Tempo de Injeção",
              "help": "Ajusta o tempo de injeção da bancada B",
              "command": "tipologia/b_b/tempo_100",
              "min": 0,
              "max": 22,
              "default": 14,
              "unit": "ms"
            },
            {
              "type": "spinbox",
              "title": "Correção de Combustível",
              "help": "Correção percentual de combustível",
              "command": "fuel_corr_b",
              "min": -50,
              "max": 50,
              "default": 0,
              "step": 1,
              "unit": "%"
            },
            {
              "type": "toggle",
              "title": "Ativar Bancada B",
              "help": "Liga ou desliga a bancada B",
              "command": "bank_b_enable",
              "default": true
            }
          ]
        }
      ]
    },
    {
      "id": "ignicao",
      "label": "Ignição",
      "icon": "bi-lightning",
      "children": [
        {
          "id": "ignicao_avanco",
          "label": "Avanço de Ignição",
          "icon": "bi-speedometer",
          "widgets": [
            {
              "type": "slider",
              "title": "Avanço Base",
              "help": "Avanço de ignição em graus",
              "command": "ign_advance",
              "min": 0,
              "max": 40,
              "default": 15,
              "unit": "°"
            }
          ]
        },
        {
          "id": "ignicao_bobinas",
          "label": "Bobinas",
          "icon": "bi-plug",
          "widgets": [
            {
              "type": "slider",
              "title": "Tempo de Carga",
              "help": "Tempo de carga das bobinas",
              "command": "ign/dl_base",
              "min": 1,
              "max": 14,
              "default": 4,
              "unit": "ms"
            },
            {
              "type": "combobox",
              "title": "Modo de Ignição",
              "help": "Selecione o modo de operação da ignição",
              "command": "tipologia/padrao/ingn",
              "mode": "classic",
              "options": [
                {"label": "Sequencial", "value": "2"},
                {"label": "Semi-Sequencial", "value": "1"},
                {"label": "Distributivo", "value": "0"}
              ],
              "default": "0"
            },{
              "type": "chart2d",
              "title": "Correção de Dwell por Voltagem",
              "help": "Ajusta o tempo de carga conforme a tensão de alimentação.",
              "command": "ignc/dl_perVol",     
              "commandX": "None",              
              "mode": "y",
              "xFixed": [6, 8, 10, 12, 14, 16, 18],
              "xMin": 6,
              "xMax": 18,
              "yMin": -50,
              "xLabel": "Tensão (V)",
              "yLabel": "Correção de Dwell (%)",
              "yMax": 154,
              "refLine": 100,
              "default": "150,120,100,100,95,90,85"
            }

          ]
        }
        
      ]
    },
    {
      "id": "sensores",
      "label": "Sensores",
      "icon": "bi-wifi",
      "children": [
        {
          "id": "sensores_temperatura",
          "label": "Temperatura",
          "icon": "bi-thermometer",
          "widgets": [
            {
              "type": "combobox",
              "title": "Tipo de Sensor",
              "help": "Tipo de sensor de temperatura",
              "command": "temp_sensor_type",
              "mode": "modern",
              "options": [
              {"label": "NTC 10K", "value": "0"},
              {"label": "NTC 5K", "value": "1"},
              {"label": "PT100", "value": "2"},
              {"label": "PT1000", "value": "3"},
              {"label": "Termopar K", "value": "4"},
              {"label": "Termopar J", "value": "5"},
              {"label": "Sensor Linear 0-5V", "value": "6"},
              {"label": "Sensor Digital", "value": "7"},
              {"label": "Resistivo Custom", "value": "8"},
              {"label": "Bypass (sem sensor)", "value": "9"}
            ],
              "default": "0"
            },
            {
              "type": "spinbox",
              "title": "Calibração",
              "help": "Offset de calibração",
              "command": "temp_calibration",
              "min": -20,
              "max": 20,
              "default": 0,
              "step": 1,
              "unit": "°C"
            }
          ]
        },
        {
          "id": "sensores_pressao",
          "label": "Pressão",
          "icon": "bi-speedometer2",
          "widgets": [
            {
              "type": "slider",
              "title": "Calibração MAP",
              "help": "Calibração do sensor MAP",
              "command": "map_calibration",
              "min": 0,
              "max": 300,
              "default": 100,
              "unit": "kPa"
            }
          ]
        }
      ]
    },
    {
      "id": "limites",
      "label": "Limites e Proteções",
      "icon": "bi-shield",
      "children": [
        {
          "id": "limites_rpm",
          "label": "Limitador de RPM",
          "icon": "bi-speedometer",
          "widgets": [
            {
              "type": "spinbox",
              "title": "RPM Máximo",
              "help": "Limite máximo de rotações por minuto",
              "command": "rpm_limit",
              "min": 1000,
              "max": 12000,
              "default": 7000,
              "step": 100,
              "unit": "RPM"
            },
            {
              "type": "toggle",
              "title": "Ativar Limitador",
              "help": "Liga ou desliga o limitador de RPM",
              "command": "rpm_limiter_enable",
              "default": true
            },
            {
              "type": "action_buttons",
              "title": "Controle de Teste",
              "description": "Botões de teste com press/release",
              "buttons": [
                {
                  "label": "Teste 1 (Press/Release)",
                  "icon": "bi-power",
                  "color": "red",
                  "mode": "press_release",
                  "commandPress": "test_btn_1_press",
                  "commandRelease": "test_btn_1_release"
                },
                {
                  "label": "Teste 2 (Toggle)",
                  "icon": "bi-play-fill",
                  "color": "green",
                  "mode": "toggle",
                  "commandPress": "test_btn_2_on",
                  "commandRelease": "test_btn_2_off"
                },
                {
                  "label": "Teste 3 (Toggle)",
                  "icon": "bi-stop-fill",
                  "color": "orange",
                  "mode": "toggle",
                  "commandPress": "test_btn_3_on",
                  "commandRelease": "test_btn_3_off"
                }
              ]
            },
            {
              "type": "color_toggle",
              "title": "Modo de Energia",
              "description": "Clique para alternar o modo de energia",
              "command": "energy_mode",
              "icon": "bi-lightning-charge",
              "label": "Energia",
              "colors": ["red", "blue", "green"],
              "valueMap": {
                "red": "eco",
                "blue": "normal",
                "green": "sport"
              },
              "toggleOnRelease": false
            },
            {
              "type": "checkbox_group",
              "title": "Configurações de Diagnóstico",
              "description": "Marque as opções desejadas",
              "checkboxes": [
                {
                  "label": "Ativar Log de Dados",
                  "command": "diag_enable_logging",
                  "icon": "bi-file-earmark-text",
                  "help": "Registra todos os parâmetros do sistema",
                  "valueOn": 1,
                  "valueOff": 0
                },
                {
                  "label": "Monitorar Sensores",
                  "command": "diag_monitor_sensors",
                  "icon": "bi-graph-up",
                  "help": "Monitora leitura em tempo real",
                  "valueOn": 1,
                  "valueOff": 0
                },
                {
                  "label": "Detectar Falhas",
                  "command": "diag_fault_detection",
                  "icon": "bi-exclamation-circle",
                  "help": "Ativa detecção automática de falhas",
                  "valueOn": 1,
                  "valueOff": 0
                },
                {
                  "label": "Modo Debug",
                  "command": "diag_debug_mode",
                  "icon": "bi-bug",
                  "help": "Modo de depuração avançado",
                  "valueOn": 1,
                  "valueOff": 0
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "id": "tabelas_3d",
      "label": "Tabelas 3D",
      "icon": "bi-grid-3x3-gap",
      "children": [
        {
          "id": "tabela_correccao_rpm",
          "label": "Correção por RPM",
          "icon": "bi-table",
          "widgets": [
            {
              "type": "table3d",
              "title": "Tabela de Correção por RPM",
              "help": "Matriz de correção: cada linha é RPM e cada coluna é um fator de ajuste. Selecione células para editar, use Shift+Click para editar inline.",
              "rows": 15,
              "cols": 20,
              "rowCommands": [
                "table_rpm_corr_row_0",
                "table_rpm_corr_row_1",
                "table_rpm_corr_row_2",
                "table_rpm_corr_row_3",
                "table_rpm_corr_row_4",
                "table_rpm_corr_row_5",
                "table_rpm_corr_row_6",
                "table_rpm_corr_row_7",
                "table_rpm_corr_row_8",
                "table_rpm_corr_row_9",
                "table_rpm_corr_row_10",
                "table_rpm_corr_row_11",
                "table_rpm_corr_row_12",
                "table_rpm_corr_row_13",
                "table_rpm_corr_row_14"
              ],
              "min": 0,
              "max": 100,
              "step": 0.1,
              "unit": "%",
              "colorMode": "heat",
              "xLabel": "Fator de Ajuste",
              "yLabel": "RPM",
              "xAxis": {
                "enabled": true,
                "min": 0,
                "max": 100,
                "command": "table_rpm_corr_x_axis"
              },
              "yAxis": {
                "enabled": true,
                "min": 1000,
                "max": 7000,
                "command": "table_rpm_corr_y_axis"
              }
            }
          ]
        },
        {
          "id": "tabela_carga_motor",
          "label": "Mapa de Carga",
          "icon": "bi-table",
          "widgets": [
            {
              "type": "table3d",
              "title": "Mapa de Carga do Motor",
              "help": "Tabela de mapa de carga: linhas = RPM, colunas = TPS (posição do acelerador). Com suporte a cores gradiente.",
              "rows": 20,
              "cols": 20,
              "rowCommands": [
                "map_load_row_0",
                "map_load_row_1",
                "map_load_row_2",
                "map_load_row_3",
                "map_load_row_4",
                "map_load_row_5",
                "map_load_row_6",
                "map_load_row_7",
                "map_load_row_8",
                "map_load_row_9",
                "map_load_row_10",
                "map_load_row_11",
                "map_load_row_12",
                "map_load_row_13",
                "map_load_row_14",
                "map_load_row_15",
                "map_load_row_16",
                "map_load_row_17",
                "map_load_row_18",
                "map_load_row_19"
              ],
              "min": 10,
              "max": 200,
              "step": 0.5,
              "unit": "kPa",
              "colorMode": "heat",
              "xLabel": "TPS (%)",
              "yLabel": "RPM (x100)",
              "xAxis": {
                "enabled": true,
                "min": 0,
                "max": 100,
                "command": "map_load_x_axis"
              },
              "yAxis": {
                "enabled": true,
                "min": 1000,
                "max": 8000,
                "command": "map_load_y_axis"
              }
            }
          ]
        }
      ]
    }
  ],
  "ecuInfo": {
    "model": "DS 300",
    "description": "Gerenciador de Motor ECU - Versão 2.0",
    "commonDiagnosticsCommand": "software/getcominfo",
    "commonDiagnosticsFrequency": 500,
    "enabled": true,
    "dataFields": [
      {
        "id": "rpm",
        "title": "RPM",
        "type": "number",
        "unit": "RPM",
        "format": "0",
        "position": 0,
        "min": 0,
        "max": 12000
      },
      {
        "id": "tps",
        "title": "Posição do Acelerador",
        "type": "number",
        "unit": "%",
        "format": "0.0",
        "position": 1,
        "min": 0,
        "max": 100
      },
      {
        "id": "coolant_temp",
        "title": "Temperatura do Coolant",
        "type": "number",
        "unit": "°C",
        "format": "0",
        "position": 2,
        "min": -40,
        "max": 150
      },
      {
        "id": "air_temp",
        "title": "Temperatura do Ar",
        "type": "number",
        "unit": "°C",
        "format": "0",
        "position": 3,
        "min": -40,
        "max": 100
      },
      {
        "id": "map_pressure",
        "title": "Pressão do Manifold",
        "type": "number",
        "unit": "kPa",
        "format": "0.0",
        "position": 4,
        "min": 0,
        "max": 300
      },
      {
        "id": "battery_voltage",
        "title": "Voltagem da Bateria",
        "type": "number",
        "unit": "V",
        "format": "0.0",
        "position": 5,
        "min": 8,
        "max": 18
      },
      {
        "id": "injection_duty",
        "title": "Duty Cycle Injeção",
        "type": "number",
        "unit": "%",
        "format": "0.0",
        "position": 6,
        "min": 0,
        "max": 100
      },
      {
        "id": "ignition_advance",
        "title": "Avanço de Ignição",
        "type": "number",
        "unit": "°",
        "format": "0.0",
        "position": 7,
        "min": -30,
        "max": 60
      },
      {
        "id": "fuel_pressure",
        "title": "Pressão do Combustível",
        "type": "number",
        "unit": "bar",
        "format": "0.00",
        "position": 8,
        "min": 0,
        "max": 10
      },
      {
        "id": "lambda",
        "title": "Lambda (O2)",
        "type": "number",
        "unit": "λ",
        "format": "0.00",
        "position": 9,
        "min": 0.5,
        "max": 1.5
      }
    ]
  },
  "dashboardButtons": [
    {
      "id": "btn_motor_test",
      "title": "Teste Motor",
      "description": "Ativa/desativa o motor de teste",
      "icon": "power",
      "color": "red",
      "mode": "press_release",
      "commandPress": "motor/start",
      "commandRelease": "motor/stop",
      "options": [
        {
          "label": "Ligar Motor",
          "description": "Ativa o motor de teste"
        },
        {
          "label": "Desligar Motor",
          "description": "Desativa o motor de teste"
        }
      ]
    },
    {
      "id": "btn_fuel_pump",
      "title": "Bomba Combustível",
      "description": "Controla a bomba de combustível com velocidade variável",
      "icon": "fuel-pump",
      "color": "green",
      "mode": "value",
      "valuePressCommand": "fuel_pump/max",
      "valueReleaseCommand": "fuel_pump/min",
      "options": [
        {
          "label": "Máxima Velocidade",
          "description": "Ativa bomba em velocidade máxima"
        },
        {
          "label": "Parar Bomba",
          "description": "Desativa a bomba de combustível"
        }
      ]
    },
    {
      "id": "btn_ignition_test",
      "title": "Teste Ignição",
      "description": "Testa o sistema de ignição do motor",
      "icon": "lightning",
      "color": "yellow",
      "mode": "toggle",
      "commandPress": "ignition/test_on",
      "commandRelease": "ignition/test_off",
      "options": [
        {
          "label": "Ignição Ativa",
          "description": "Ativa o sistema de teste de ignição"
        },
        {
          "label": "Ignição Inativa",
          "description": "Desativa o teste de ignição"
        }
      ]
    },
    {
      "id": "btn_diagnostics",
      "title": "Diagnósticos",
      "description": "Executa rotina completa de diagnósticos do motor",
      "icon": "tools",
      "color": "blue",
      "mode": "press_release",
      "commandPress": "diagnostics/start",
      "commandRelease": "diagnostics/stop",
      "options": [
        {
          "label": "Iniciar Diagnósticos",
          "description": "Começa a rotina de diagnósticos completa"
        },
        {
          "label": "Parar Diagnósticos",
          "description": "Interrompe a rotina de diagnósticos"
        }
      ]
    },
    {
      "id": "btn_data_logging",
      "title": "Registro de Dados",
      "description": "Controla o registro de dados do motor em tempo real",
      "icon": "file-earmark-text",
      "color": "purple",
      "mode": "toggle",
      "commandPress": "datalog/start",
      "commandRelease": "datalog/stop",
      "options": [
        {
          "label": "Iniciar Gravação",
          "description": "Começa a registrar dados do motor"
        },
        {
          "label": "Parar Gravação",
          "description": "Interrompe o registro de dados"
        }
      ]
    },
    {
      "id": "btn_injection_toggle",
      "title": "Controle de Injeção",
      "description": "Alterna o estado da injeção com valores (estateful_toggle)",
      "icon": "droplet",
      "color": "red",
      "colorOn": "green",
      "iconOn": "check-circle",
      "mode": "stateful_toggle",
      "command": "injecao/status",
      "valueOn": 1,
      "valueOff": 0,
      "options": [
        {
          "label": "Ativar Injeção",
          "description": "Liga a injeção do motor"
        },
        {
          "label": "Desativar Injeção",
          "description": "Desliga a injeção do motor"
        }
      ]
    },
    {
      "id": "btn_fan_control",
      "title": "Controle do Ventilador",
      "description": "Ventilador com dois níveis (apertar/soltar = velocidades)",
      "icon": "fan",
      "color": "blue",
      "colorOn": "cyan",
      "iconOn": "fan",
      "mode": "stateful_value",
      "command": "fan/speed",
      "valuePress": 100,
      "valueRelease": 0,
      "options": [
        {
          "label": "Ventilador Ligado",
          "description": "Velocidade máxima"
        },
        {
          "label": "Ventilador Desligado",
          "description": "Parado"
        }
      ]
    }
  ]
}