<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Table3D com Eixos Editáveis</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body style="padding: 20px; background: #1a1a1a; color: #e0e0e0;">
    <h1><i class="bi bi-table"></i> Teste - Table3D com Eixos Editáveis</h1>
    <hr>
    
    <div id="table3d-container" style="margin-top: 20px;"></div>

    <script src="dialogs.js"></script>
    <script src="notifications.js"></script>
    <script src="history.js"></script>
    <script src="table3d-controller.js"></script>

    <script>
        // Simulando o notificationManager
        if (!window.notificationManager) {
            window.notificationManager = {
                info: (msg) => console.log('INFO:', msg),
                error: (title, msg) => console.error('ERROR:', title, msg)
            };
        }

        // Simulando o globalHistoryManager
        if (!window.globalHistoryManager) {
            window.globalHistoryManager = {
                createSnapshot: () => ({}),
                push: () => {}
            };
        }

        // Dados de teste
        const mockCurrentValue = {
            'table_rpm_corr_row_0': '10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,100',
            'table_rpm_corr_row_1': '12,17,22,27,32,37,42,47,52,57,62,67,72,77,82,87,92,97,100,100',
            'table_rpm_corr_row_2': '14,19,24,29,34,39,44,49,54,59,64,69,74,79,84,89,94,99,100,100',
            'table_rpm_corr_row_3': '16,21,26,31,36,41,46,51,56,61,66,71,76,81,86,91,96,100,100,100',
            'table_rpm_corr_row_4': '18,23,28,33,38,43,48,53,58,63,68,73,78,83,88,93,98,100,100,100',
            'table_rpm_corr_row_5': '20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,100,100,100',
            'table_rpm_corr_row_6': '22,27,32,37,42,47,52,57,62,67,72,77,82,87,92,97,100,100,100,100',
            'table_rpm_corr_row_7': '24,29,34,39,44,49,54,59,64,69,74,79,84,89,94,99,100,100,100,100',
            'table_rpm_corr_row_8': '26,31,36,41,46,51,56,61,66,71,76,81,86,91,96,100,100,100,100,100',
            'table_rpm_corr_row_9': '28,33,38,43,48,53,58,63,68,73,78,83,88,93,98,100,100,100,100,100',
            'table_rpm_corr_row_10': '30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,100,100,100,100,100',
            'table_rpm_corr_row_11': '32,37,42,47,52,57,62,67,72,77,82,87,92,97,100,100,100,100,100,100',
            'table_rpm_corr_row_12': '34,39,44,49,54,59,64,69,74,79,84,89,94,99,100,100,100,100,100,100',
            'table_rpm_corr_row_13': '36,41,46,51,56,61,66,71,76,81,86,91,96,100,100,100,100,100,100,100',
            'table_rpm_corr_row_14': '38,43,48,53,58,63,68,73,78,83,88,93,98,100,100,100,100,100,100,100'
        };

        // Widget de teste com eixos
        const testWidget = {
            type: 'table3d',
            title: 'Tabela de Correção por RPM',
            help: 'Teste com eixos editáveis',
            rows: 15,
            cols: 20,
            rowCommands: [
                'table_rpm_corr_row_0', 'table_rpm_corr_row_1', 'table_rpm_corr_row_2',
                'table_rpm_corr_row_3', 'table_rpm_corr_row_4', 'table_rpm_corr_row_5',
                'table_rpm_corr_row_6', 'table_rpm_corr_row_7', 'table_rpm_corr_row_8',
                'table_rpm_corr_row_9', 'table_rpm_corr_row_10', 'table_rpm_corr_row_11',
                'table_rpm_corr_row_12', 'table_rpm_corr_row_13', 'table_rpm_corr_row_14'
            ],
            min: 0,
            max: 100,
            step: 0.1,
            unit: '%',
            colorMode: 'heat',
            xLabel: 'Fator de Ajuste',
            yLabel: 'RPM',
            currentValue: mockCurrentValue,
            xAxis: {
                enabled: true,
                min: 0,
                max: 100,
                command: 'table_rpm_corr_x_axis'
            },
            yAxis: {
                enabled: true,
                min: 1000,
                max: 7000,
                command: 'table_rpm_corr_y_axis'
            }
        };

        // Função para lidar com mudanças de valor
        function onValueChange(command, value) {
            console.log(`Comando: ${command}, Valor: ${value}`);
            mockCurrentValue[command] = value;
        }

        // Criar o controller
        const controller = new Table3DController(testWidget, onValueChange);
        const element = controller.create();

        // Adicionar ao DOM
        const container = document.getElementById('table3d-container');
        container.appendChild(element);

        console.log('Table3D inicializado com eixos editáveis!');
    </script>
</body>
</html>
